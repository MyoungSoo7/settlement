<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MD Viewer</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/12.0.1/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;500;700&family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f0f0f;
    --bg-secondary: #1a1a1a;
    --bg-tertiary: #242424;
    --text: #e8e6e3;
    --text-muted: #8a8a8a;
    --accent: #c9a55a;
    --accent-dim: #c9a55a33;
    --border: #2a2a2a;
    --code-bg: #161616;
    --shadow: 0 8px 32px rgba(0,0,0,0.4);
  }

  .light {
    --bg: #faf9f6;
    --bg-secondary: #ffffff;
    --bg-tertiary: #f0efe9;
    --text: #1a1a1a;
    --text-muted: #777;
    --accent: #9e7c3b;
    --accent-dim: #9e7c3b1a;
    --border: #e4e0d8;
    --code-bg: #f5f2eb;
    --shadow: 0 8px 32px rgba(0,0,0,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Noto Sans KR', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    transition: background 0.4s, color 0.4s;
  }

  /* â”€â”€â”€ Top Bar â”€â”€â”€ */
  .topbar {
    position: fixed;
    top: 0; left: 0; right: 0;
    height: 52px;
    background: var(--bg-secondary);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    padding: 0 20px;
    z-index: 100;
    backdrop-filter: blur(12px);
    gap: 12px;
    transition: background 0.4s, border 0.4s;
  }

  .topbar-logo {
    font-family: 'Playfair Display', serif;
    font-weight: 900;
    font-size: 18px;
    color: var(--accent);
    letter-spacing: -0.5px;
    white-space: nowrap;
  }

  .topbar-filename {
    flex: 1;
    font-size: 13px;
    color: var(--text-muted);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-weight: 400;
  }

  .topbar-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 6px 14px;
    border-radius: 6px;
    font-size: 12px;
    font-family: 'Noto Sans KR', sans-serif;
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .topbar-btn:hover {
    border-color: var(--accent);
    color: var(--accent);
    background: var(--accent-dim);
  }

  .topbar-btn.icon {
    padding: 6px 8px;
    font-size: 16px;
    line-height: 1;
  }

  /* â”€â”€â”€ Drop Zone / Welcome â”€â”€â”€ */
  .welcome {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 52px 20px 20px;
    transition: opacity 0.3s;
  }

  .welcome.hidden { display: none; }

  .drop-zone {
    width: 100%;
    max-width: 520px;
    border: 2px dashed var(--border);
    border-radius: 16px;
    padding: 64px 40px;
    text-align: center;
    transition: all 0.3s;
    cursor: pointer;
    position: relative;
  }

  .drop-zone:hover,
  .drop-zone.drag-over {
    border-color: var(--accent);
    background: var(--accent-dim);
  }

  .drop-zone-icon {
    font-size: 48px;
    margin-bottom: 20px;
    opacity: 0.3;
  }

  .drop-zone h2 {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 22px;
    margin-bottom: 8px;
    color: var(--text);
  }

  .drop-zone p {
    font-size: 14px;
    color: var(--text-muted);
    line-height: 1.6;
  }

  .drop-zone kbd {
    display: inline-block;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 2px 7px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    color: var(--text-muted);
    margin: 0 1px;
  }

  /* â”€â”€â”€ Content â”€â”€â”€ */
  .content {
    display: none;
    max-width: 780px;
    margin: 0 auto;
    padding: 80px 32px 80px;
  }

  .content.visible { display: block; }

  /* â”€â”€â”€ Markdown Rendered Styles â”€â”€â”€ */
  .md-body {
    font-size: 16px;
    line-height: 1.85;
    color: var(--text);
    font-weight: 300;
  }

  .md-body h1 {
    font-family: 'Playfair Display', serif;
    font-weight: 900;
    font-size: 2.4em;
    margin: 1.6em 0 0.6em;
    letter-spacing: -1px;
    line-height: 1.2;
    color: var(--text);
    border-bottom: 2px solid var(--accent);
    padding-bottom: 0.3em;
  }

  .md-body h1:first-child { margin-top: 0; }

  .md-body h2 {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 1.7em;
    margin: 1.8em 0 0.5em;
    letter-spacing: -0.5px;
    line-height: 1.3;
    color: var(--accent);
  }

  .md-body h3 {
    font-weight: 700;
    font-size: 1.2em;
    margin: 1.6em 0 0.4em;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 0.85em;
    color: var(--text-muted);
  }

  .md-body h4, .md-body h5, .md-body h6 {
    font-weight: 500;
    font-size: 1em;
    margin: 1.4em 0 0.3em;
  }

  .md-body p { margin: 0 0 1.2em; }

  .md-body a {
    color: var(--accent);
    text-decoration: underline;
    text-underline-offset: 3px;
    text-decoration-thickness: 1px;
    transition: opacity 0.2s;
  }

  .md-body a:hover { opacity: 0.7; }

  .md-body strong { font-weight: 700; }

  .md-body em { font-style: italic; }

  .md-body blockquote {
    border-left: 3px solid var(--accent);
    padding: 0.6em 1.2em;
    margin: 1.2em 0;
    background: var(--accent-dim);
    border-radius: 0 8px 8px 0;
    color: var(--text-muted);
    font-style: italic;
  }

  .md-body blockquote p:last-child { margin-bottom: 0; }

  .md-body ul, .md-body ol {
    margin: 0 0 1.2em;
    padding-left: 1.6em;
  }

  .md-body li { margin-bottom: 0.4em; }

  .md-body li::marker { color: var(--accent); }

  .md-body code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85em;
    background: var(--code-bg);
    padding: 2px 7px;
    border-radius: 4px;
    border: 1px solid var(--border);
  }

  .md-body pre {
    margin: 1.4em 0;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid var(--border);
  }

  .md-body pre code {
    display: block;
    padding: 20px 24px;
    background: var(--code-bg);
    font-size: 13px;
    line-height: 1.7;
    overflow-x: auto;
    border: none;
    border-radius: 0;
  }

  .md-body hr {
    border: none;
    height: 1px;
    background: var(--border);
    margin: 2.4em 0;
  }

  .md-body table {
    width: 100%;
    border-collapse: collapse;
    margin: 1.4em 0;
    font-size: 14px;
  }

  .md-body th {
    text-align: left;
    padding: 10px 14px;
    border-bottom: 2px solid var(--accent);
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--text-muted);
  }

  .md-body td {
    padding: 10px 14px;
    border-bottom: 1px solid var(--border);
  }

  .md-body img {
    max-width: 100%;
    border-radius: 8px;
    margin: 1em 0;
  }

  .md-body input[type="checkbox"] {
    accent-color: var(--accent);
    margin-right: 6px;
  }

  /* â”€â”€â”€ Scroll to Top â”€â”€â”€ */
  .scroll-top {
    position: fixed;
    bottom: 28px;
    right: 28px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    color: var(--text-muted);
    font-size: 18px;
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    z-index: 90;
  }

  .scroll-top:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  .scroll-top.visible { display: flex; }

  /* â”€â”€â”€ Drag overlay â”€â”€â”€ */
  .drag-overlay {
    position: fixed;
    inset: 0;
    background: var(--bg);
    opacity: 0;
    pointer-events: none;
    z-index: 200;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.25s;
  }

  .drag-overlay.active {
    opacity: 0.95;
    pointer-events: auto;
  }

  .drag-overlay-inner {
    text-align: center;
  }

  .drag-overlay-inner span {
    font-size: 48px;
    display: block;
    margin-bottom: 16px;
  }

  .drag-overlay-inner p {
    font-family: 'Playfair Display', serif;
    font-size: 22px;
    color: var(--accent);
  }

  /* â”€â”€â”€ TOC sidebar â”€â”€â”€ */
  .toc-panel {
    position: fixed;
    top: 52px;
    left: 0;
    bottom: 0;
    width: 280px;
    background: var(--bg-secondary);
    border-right: 1px solid var(--border);
    overflow-y: auto;
    padding: 24px 16px;
    transform: translateX(-100%);
    transition: transform 0.3s ease, background 0.4s;
    z-index: 90;
  }

  .toc-panel.open { transform: translateX(0); }

  .toc-title {
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: var(--text-muted);
    margin-bottom: 16px;
    font-weight: 500;
  }

  .toc-link {
    display: block;
    padding: 5px 0;
    font-size: 13px;
    color: var(--text-muted);
    text-decoration: none;
    transition: color 0.2s;
    line-height: 1.5;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .toc-link:hover { color: var(--accent); }
  .toc-link.depth-2 { padding-left: 16px; font-size: 12px; }
  .toc-link.depth-3 { padding-left: 32px; font-size: 11px; }

  /* â”€â”€â”€ Responsive â”€â”€â”€ */
  @media (max-width: 600px) {
    .content { padding: 68px 18px 60px; }
    .md-body h1 { font-size: 1.8em; }
    .md-body h2 { font-size: 1.3em; }
    .toc-panel { width: 240px; }
  }

  /* smooth scroll */
  html { scroll-behavior: smooth; }

  /* scrollbar */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }
</style>
</head>
<body>

<!-- Top Bar -->
<div class="topbar">
  <div class="topbar-logo">MD</div>
  <span class="topbar-filename" id="filename">íŒŒì¼ ì—†ìŒ</span>
  <button class="topbar-btn" id="tocBtn" style="display:none" onclick="toggleToc()">ëª©ì°¨</button>
  <button class="topbar-btn" onclick="openFile()">íŒŒì¼ ì—´ê¸°</button>
  <button class="topbar-btn icon" id="themeBtn" onclick="toggleTheme()" title="í…Œë§ˆ ì „í™˜">â—</button>
</div>

<!-- TOC Panel -->
<div class="toc-panel" id="tocPanel">
  <div class="toc-title">ëª©ì°¨</div>
  <div id="tocList"></div>
</div>

<!-- Welcome / Drop Zone -->
<div class="welcome" id="welcome">
  <div class="drop-zone" id="dropZone" onclick="openFile()">
    <div class="drop-zone-icon">ğŸ“„</div>
    <h2>ë§ˆí¬ë‹¤ìš´ íŒŒì¼ì„ ì—´ì–´ë³´ì„¸ìš”</h2>
    <p>ì—¬ê¸°ì— <strong>.md íŒŒì¼</strong>ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•´ì„œ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤<br>
    <kbd>Ctrl</kbd>+<kbd>O</kbd> ë¡œë„ ì—´ ìˆ˜ ìˆì–´ìš”</p>
  </div>
</div>

<!-- Rendered Content -->
<div class="content" id="content">
  <div class="md-body" id="mdBody"></div>
</div>

<!-- Drag Overlay -->
<div class="drag-overlay" id="dragOverlay">
  <div class="drag-overlay-inner">
    <span>ğŸ“„</span>
    <p>ë†“ì•„ì„œ íŒŒì¼ ì—´ê¸°</p>
  </div>
</div>

<!-- Scroll to top -->
<button class="scroll-top" id="scrollTop" onclick="window.scrollTo({top:0})">â†‘</button>

<!-- Hidden file input -->
<input type="file" id="fileInput" accept=".md,.markdown,.txt" style="display:none">

<script>
  // â”€â”€â”€ Marked config â”€â”€â”€
  marked.setOptions({
    highlight: function(code, lang) {
      if (lang && hljs.getLanguage(lang)) {
        return hljs.highlight(code, { language: lang }).value;
      }
      return hljs.highlightAuto(code).value;
    },
    breaks: true,
    gfm: true
  });

  // â”€â”€â”€ Elements â”€â”€â”€
  const welcome = document.getElementById('welcome');
  const content = document.getElementById('content');
  const mdBody = document.getElementById('mdBody');
  const filenameEl = document.getElementById('filename');
  const fileInput = document.getElementById('fileInput');
  const dropZone = document.getElementById('dropZone');
  const dragOverlay = document.getElementById('dragOverlay');
  const tocPanel = document.getElementById('tocPanel');
  const tocList = document.getElementById('tocList');
  const tocBtn = document.getElementById('tocBtn');
  const scrollTopBtn = document.getElementById('scrollTop');

  // â”€â”€â”€ Theme â”€â”€â”€
  let isDark = true;
  function toggleTheme() {
    isDark = !isDark;
    document.body.classList.toggle('light', !isDark);
  }

  // â”€â”€â”€ TOC â”€â”€â”€
  let tocOpen = false;
  function toggleToc() {
    tocOpen = !tocOpen;
    tocPanel.classList.toggle('open', tocOpen);
  }

  function buildToc() {
    const headings = mdBody.querySelectorAll('h1, h2, h3');
    tocList.innerHTML = '';
    if (headings.length === 0) {
      tocBtn.style.display = 'none';
      return;
    }
    tocBtn.style.display = '';
    headings.forEach((h, i) => {
      const id = 'heading-' + i;
      h.id = id;
      const a = document.createElement('a');
      a.className = 'toc-link depth-' + h.tagName[1];
      a.href = '#' + id;
      a.textContent = h.textContent;
      a.onclick = () => { if (window.innerWidth < 800) toggleToc(); };
      tocList.appendChild(a);
    });
  }

  // â”€â”€â”€ Render markdown â”€â”€â”€
  function renderMarkdown(text, filename) {
    mdBody.innerHTML = marked.parse(text);
    filenameEl.textContent = filename || 'íŒŒì¼ ì—†ìŒ';
    welcome.classList.add('hidden');
    content.classList.add('visible');
    buildToc();
    window.scrollTo({ top: 0 });
  }

  // â”€â”€â”€ File reading â”€â”€â”€
  function readFile(file) {
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => renderMarkdown(e.target.result, file.name);
    reader.readAsText(file);
  }

  function openFile() {
    fileInput.click();
  }

  fileInput.addEventListener('change', (e) => {
    if (e.target.files[0]) readFile(e.target.files[0]);
  });

  // â”€â”€â”€ Drag and drop â”€â”€â”€
  let dragCount = 0;

  document.addEventListener('dragenter', (e) => {
    e.preventDefault();
    dragCount++;
    dragOverlay.classList.add('active');
  });

  document.addEventListener('dragleave', (e) => {
    e.preventDefault();
    dragCount--;
    if (dragCount <= 0) {
      dragCount = 0;
      dragOverlay.classList.remove('active');
    }
  });

  document.addEventListener('dragover', (e) => e.preventDefault());

  document.addEventListener('drop', (e) => {
    e.preventDefault();
    dragCount = 0;
    dragOverlay.classList.remove('active');
    const file = e.dataTransfer.files[0];
    if (file) readFile(file);
  });

  // â”€â”€â”€ Keyboard shortcut â”€â”€â”€
  document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
      e.preventDefault();
      openFile();
    }
  });

  // â”€â”€â”€ Scroll to top button â”€â”€â”€
  window.addEventListener('scroll', () => {
    scrollTopBtn.classList.toggle('visible', window.scrollY > 400);
  });
</script>
</body>
</html>
