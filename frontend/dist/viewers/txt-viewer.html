<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', 'Consolas', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            line-height: 1.6;
        }

        #toolbar {
            position: sticky;
            top: 0;
            background: #2d2d30;
            border: 1px solid #3e3e42;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            z-index: 100;
        }

        #toolbar button,
        #toolbar select,
        #toolbar input[type="number"] {
            padding: 8px 16px;
            background: #3e3e42;
            border: 1px solid #555;
            border-radius: 6px;
            color: #d4d4d4;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        #toolbar button:hover {
            background: #4e4e52;
        }

        #toolbar input[type="file"] {
            padding: 8px;
            font-size: 14px;
            background: #3e3e42;
            color: #d4d4d4;
            border: 1px solid #555;
            border-radius: 6px;
        }

        #toolbar label {
            color: #d4d4d4;
            font-size: 14px;
        }

        #info {
            background: #2d2d30;
            border: 1px solid #3e3e42;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 20px;
            display: none;
        }

        #info.show {
            display: block;
        }

        #info-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            color: #d4d4d4;
            font-size: 14px;
        }

        #info-content div {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        #info-content .label {
            color: #808080;
            font-size: 12px;
        }

        #info-content .value {
            color: #4ec9b0;
            font-weight: bold;
        }

        #content {
            background: #1e1e1e;
            padding: 20px;
            border: 1px solid #3e3e42;
            border-radius: 6px;
            min-height: 500px;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-x: auto;
            position: relative;
        }

        #line-numbers {
            position: absolute;
            left: 0;
            top: 20px;
            padding: 0 10px;
            background: #252526;
            border-right: 1px solid #3e3e42;
            color: #858585;
            user-select: none;
            font-size: 14px;
            line-height: 1.6;
        }

        #text-content {
            padding-left: 60px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #808080;
        }

        .empty-state h2 {
            font-size: 1.5em;
            margin-bottom: 12px;
            color: #d4d4d4;
        }

        /* ê²€ìƒ‰ í•˜ì´ë¼ì´íŠ¸ */
        .highlight {
            background-color: #ffff00;
            color: #000;
            padding: 2px 0;
        }

        .current-highlight {
            background-color: #ff6b35;
            color: #fff;
        }

        /* í…Œë§ˆë³„ ìŠ¤íƒ€ì¼ */
        .theme-light {
            background: #ffffff;
            color: #000000;
        }

        .theme-light #toolbar,
        .theme-light #info,
        .theme-light #content {
            background: #f5f5f5;
            border-color: #d0d0d0;
            color: #000000;
        }

        .theme-light #line-numbers {
            background: #e8e8e8;
            color: #858585;
        }

        .theme-solarized {
            background: #002b36;
            color: #839496;
        }

        .theme-solarized #toolbar,
        .theme-solarized #info,
        .theme-solarized #content {
            background: #073642;
            border-color: #586e75;
            color: #839496;
        }
    </style>
</head>
<body>
    <div id="toolbar">
        <input type="file" id="fileInput" accept=".txt,.log,.csv,.json,.xml,.html,.css,.js,.ts,.java,.py,.md">
        <button onclick="loadSample()">ğŸ“ ìƒ˜í”Œ ë¡œë“œ</button>
        <button onclick="clearContent()">ğŸ—‘ï¸ ì´ˆê¸°í™”</button>

        <label>í°íŠ¸ í¬ê¸°:</label>
        <input type="number" id="fontSize" value="14" min="8" max="32" onchange="changeFontSize()">

        <select id="themeSelect" onchange="changeTheme()">
            <option value="dark">ë‹¤í¬ í…Œë§ˆ</option>
            <option value="light">ë¼ì´íŠ¸ í…Œë§ˆ</option>
            <option value="solarized">Solarized</option>
        </select>

        <button onclick="toggleLineNumbers()">ğŸ”¢ ì¤„ ë²ˆí˜¸</button>
        <button onclick="toggleInfo()">â„¹ï¸ ì •ë³´</button>
        <button onclick="downloadFile()">ğŸ’¾ ë‹¤ìš´ë¡œë“œ</button>
        <button onclick="copyToClipboard()">ğŸ“‹ ë³µì‚¬</button>

        <input type="text" id="searchInput" placeholder="ê²€ìƒ‰..." style="padding: 8px;">
        <button onclick="search()">ğŸ” ê²€ìƒ‰</button>
    </div>

    <div id="info">
        <div id="info-content"></div>
    </div>

    <div id="content">
        <div id="line-numbers"></div>
        <div id="text-content">
            <div class="empty-state">
                <h2>ğŸ“„ Text Viewer</h2>
                <p>í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ìƒ˜í”Œì„ ë¡œë“œí•˜ì„¸ìš”.</p>
                <p style="margin-top: 12px; font-size: 12px;">
                    ì§€ì› í˜•ì‹: TXT, LOG, CSV, JSON, XML, HTML, CSS, JS, TS, Java, Python, Markdown ë“±
                </p>
            </div>
        </div>
    </div>

    <script>
        let currentContent = '';
        let currentFileName = '';
        let showLineNumbers = true;
        let searchResults = [];
        let currentSearchIndex = -1;

        // íŒŒì¼ ì—…ë¡œë“œ
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            currentFileName = file.name;
            const reader = new FileReader();

            reader.onload = function(event) {
                currentContent = event.target.result;
                displayContent(currentContent);
                updateInfo(file);
            };

            reader.readAsText(file);
        });

        // ì»¨í…ì¸  í‘œì‹œ
        function displayContent(text) {
            const lines = text.split('\n');
            const lineNumbersHTML = lines.map((_, i) => i + 1).join('\n');

            document.getElementById('line-numbers').textContent = showLineNumbers ? lineNumbersHTML : '';
            document.getElementById('text-content').textContent = text;
        }

        // íŒŒì¼ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateInfo(file) {
            const lines = currentContent.split('\n').length;
            const chars = currentContent.length;
            const words = currentContent.split(/\s+/).filter(w => w.length > 0).length;
            const size = (file.size / 1024).toFixed(2);

            const infoHTML = `
                <div><span class="label">íŒŒì¼ëª…</span><span class="value">${file.name}</span></div>
                <div><span class="label">í¬ê¸°</span><span class="value">${size} KB</span></div>
                <div><span class="label">ì¤„ ìˆ˜</span><span class="value">${lines.toLocaleString()}</span></div>
                <div><span class="label">ë¬¸ì ìˆ˜</span><span class="value">${chars.toLocaleString()}</span></div>
                <div><span class="label">ë‹¨ì–´ ìˆ˜</span><span class="value">${words.toLocaleString()}</span></div>
                <div><span class="label">ì¸ì½”ë”©</span><span class="value">UTF-8</span></div>
            `;

            document.getElementById('info-content').innerHTML = infoHTML;
        }

        // ìƒ˜í”Œ ë¡œë“œ
        function loadSample() {
            const sample = `í…ìŠ¤íŠ¸ ë·°ì–´ ìƒ˜í”Œ íŒŒì¼
====================

ì´ê²ƒì€ ìƒ˜í”Œ í…ìŠ¤íŠ¸ íŒŒì¼ì…ë‹ˆë‹¤.

ì£¼ìš” ê¸°ëŠ¥:
1. í…ìŠ¤íŠ¸ íŒŒì¼ ì—´ê¸° (.txt, .log, .csv ë“±)
2. ì¤„ ë²ˆí˜¸ í‘œì‹œ/ìˆ¨ê¹€
3. ë‹¤ì–‘í•œ í…Œë§ˆ (ë‹¤í¬, ë¼ì´íŠ¸, Solarized)
4. í°íŠ¸ í¬ê¸° ì¡°ì ˆ
5. í…ìŠ¤íŠ¸ ê²€ìƒ‰
6. íŒŒì¼ ì •ë³´ í‘œì‹œ
7. í´ë¦½ë³´ë“œ ë³µì‚¬
8. íŒŒì¼ ë‹¤ìš´ë¡œë“œ

ì½”ë“œ ì˜ˆì‹œ:

function hello() {
    console.log("Hello, World!");
    return true;
}

JSON ì˜ˆì‹œ:
{
    "name": "Lemuel",
    "version": "1.0.0",
    "features": ["viewer", "editor", "search"]
}

ë‹¤êµ­ì–´ ì§€ì›:
- í•œê¸€: ì•ˆë…•í•˜ì„¸ìš”
- English: Hello
- æ—¥æœ¬èª: ã“ã‚“ã«ã¡ã¯
- ä¸­æ–‡: ä½ å¥½

íŠ¹ìˆ˜ ë¬¸ì: !@#$%^&*()_+-=[]{}|;:',.<>?/~\`

ê¸´ ì¤„ í…ŒìŠ¤íŠ¸: ${'a'.repeat(100)}

ë.`;

            currentContent = sample;
            currentFileName = 'sample.txt';
            displayContent(sample);

            // ê°€ìƒ íŒŒì¼ ì •ë³´
            const info = `
                <div><span class="label">íŒŒì¼ëª…</span><span class="value">sample.txt</span></div>
                <div><span class="label">í¬ê¸°</span><span class="value">0.68 KB</span></div>
                <div><span class="label">ì¤„ ìˆ˜</span><span class="value">${sample.split('\n').length}</span></div>
                <div><span class="label">ë¬¸ì ìˆ˜</span><span class="value">${sample.length}</span></div>
                <div><span class="label">ë‹¨ì–´ ìˆ˜</span><span class="value">${sample.split(/\s+/).filter(w => w.length > 0).length}</span></div>
                <div><span class="label">ì¸ì½”ë”©</span><span class="value">UTF-8</span></div>
            `;
            document.getElementById('info-content').innerHTML = info;
        }

        // ì´ˆê¸°í™”
        function clearContent() {
            currentContent = '';
            currentFileName = '';
            document.getElementById('content').innerHTML = `
                <div id="line-numbers"></div>
                <div id="text-content">
                    <div class="empty-state">
                        <h2>ğŸ“„ Text Viewer</h2>
                        <p>í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ìƒ˜í”Œì„ ë¡œë“œí•˜ì„¸ìš”.</p>
                    </div>
                </div>
            `;
            document.getElementById('fileInput').value = '';
            document.getElementById('info').classList.remove('show');
        }

        // í°íŠ¸ í¬ê¸° ë³€ê²½
        function changeFontSize() {
            const size = document.getElementById('fontSize').value;
            document.getElementById('text-content').style.fontSize = size + 'px';
            document.getElementById('line-numbers').style.fontSize = size + 'px';
        }

        // í…Œë§ˆ ë³€ê²½
        function changeTheme() {
            const theme = document.getElementById('themeSelect').value;
            document.body.className = 'theme-' + theme;
        }

        // ì¤„ ë²ˆí˜¸ í† ê¸€
        function toggleLineNumbers() {
            showLineNumbers = !showLineNumbers;
            if (currentContent) {
                displayContent(currentContent);
            }
            document.getElementById('text-content').style.paddingLeft = showLineNumbers ? '60px' : '0';
        }

        // ì •ë³´ í† ê¸€
        function toggleInfo() {
            document.getElementById('info').classList.toggle('show');
        }

        // ë‹¤ìš´ë¡œë“œ
        function downloadFile() {
            if (!currentContent) {
                alert('ë‹¤ìš´ë¡œë“œí•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const blob = new Blob([currentContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = currentFileName || 'download.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // í´ë¦½ë³´ë“œ ë³µì‚¬
        function copyToClipboard() {
            if (!currentContent) {
                alert('ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            navigator.clipboard.writeText(currentContent).then(() => {
                alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
            });
        }

        // ê²€ìƒ‰
        function search() {
            const query = document.getElementById('searchInput').value;
            if (!query || !currentContent) return;

            const content = document.getElementById('text-content');
            let html = currentContent;

            // ì´ì „ í•˜ì´ë¼ì´íŠ¸ ì œê±°
            html = html.replace(/<span class="highlight.*?<\/span>/g, '');

            // ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸
            const regex = new RegExp(query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'gi');
            const matches = currentContent.match(regex);

            if (matches) {
                html = html.replace(regex, '<span class="highlight">$&</span>');
                content.innerHTML = html;
                alert(`${matches.length}ê°œì˜ ê²°ê³¼ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.`);
            } else {
                alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ë©”ì‹œì§€ ìˆ˜ì‹  (ë¶€ëª¨ ì°½ì—ì„œ ì»¨í…ì¸  ì „ë‹¬)
        window.addEventListener('message', function(event) {
            if (event.data.type === 'loadText') {
                currentContent = event.data.content;
                currentFileName = event.data.filename || 'document.txt';
                displayContent(currentContent);
            }
        });
    </script>
</body>
</html>
